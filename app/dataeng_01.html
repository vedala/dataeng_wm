<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="dataeng_01.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <script src="endpoints.js"></script>
        <script src="dataeng_01.js"></script>
    </head>
    <body>
        <header>
            <h1>Data Engineering Tutorial - Analysis</h1>
        </header>
        <main>
            <hr>
            <section>
                <h2>Data Source</h2>
                <p>
                    Data used for this tutorial is the Walmart Recruiting Store Sales data.
                </p>
                <p>
                    Source data located <a href="https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting">here</a>.
                </p>
                <p>
                    The data provided is historical sales data for 45 Walmart stores for years
                    2010 thru 2012.
                </p>
                <p>
                    The primary data is weekly department-wise sales amount for each store.
                    Another piece of information included is whether a given week is a holiday
                    week or a reguler week. For the purpose of this data, only the following four
                    holidays are considered: Super Bowl, Labor Day, Thanksgiving and
                    Christmas.
                </p>

            </section>
            <hr>
            <section>
                <h2>Schema Design</h2>
                <p>
                    Applying dimensional design process on the data yields one dimension
                    and two fact tables:
                </p>
                <ul>
                    <li>date dimension</li>
                    <li>sales fact</li>
                    <li>features fact</li>
                </ul>
            </section>
            <hr>
            <section>
                <h2>Data Cleaning and Preparation</h2>
                <p>
                    <a href="https://www.stitchdata.com/">Stitch</a> ETL tool is used
                    to load data into data warehouse.
                </p>
                <p>
                    Cleaning and prepration is done while creating each of the
                    dimension and fact CSV files.
                </p>
                <p>
                    Data cleaning and prepartion scripts are implemented as AWS Lambda
                    functions. Source data files to AWS S3 and the Lambda functions download
                    the source data files, clean and prepare CSV files containing dimension
                    & fact data and store the generated files back to S3.
                </p>
                <p>
                    Links to source code of the Lambda functions are:
                </p>
                <ul>
                    <li><a href="https://github.com/vedala/dataeng_wm/blob/master/lambda/prepare_datedim.sh">Date dimension Lambda function</a></li>
                    <li><a href="https://github.com/vedala/dataeng_wm/blob/master/lambda/prepare_salesfact.sh">Sales fact Lambda function</a></li>
                    <li><a href="https://github.com/vedala/dataeng_wm/blob/master/lambda/prepare_featuresfact.sh">Features fact Lambda function</a></li>
                </ul>
            </section>
            <hr>

            <section>
                <h2>Data Load</h2>
                <h3>ETL Tool</h3>
                <p>
                    ETL tool used is Stitch (<a href="https://www.stitchdata.com/">link</a>).
                </p>
                <p>
                    Stitch is a sync-only provider. Stitch tool does not provide any
                    transform ability.
                </p>
                <h3>Data Warehouse</h3>
                <p>
                    Data loaded into an AWS RDS PostgreSQL instance.
                </p>
            </section>
            <hr>
            <section>
                <h2>Analysis</h2>
                <p>
                    The following analyses are a sample of possible analyses that can be
                    performed on the data.
                </p>
                <h3>Overview</h3>
                <ul>
                    <li>Analysis buttons kick off ajax calls to AWS Lambda functions</li>
                    <li>The lambda functions run analysis SQL queries on the postgres
                        database and return the result to the web application</li>
                    <li>Chartjs is used for rendering charts</li>
                </ul>

                <h3>Implementation</h3>
                <ul>
                    <li><a href="https://github.com/vedala/dataeng_wm/blob/master/lambda/analysis501.py">Analysis-1 Lambda function</a></li>
                    <li><a href="https://github.com/vedala/dataeng_wm/blob/master/lambda/analysis502.py">Analysis-2 Lambda function</a></li>
                </ul>

                <article>
                    <h3>Analysis 1 - Data Availability, Number of Weeks per Year</h3>
                    <p>
                        An extremely simple analysis. Counts the number of weeks for which
                        data is available for each year.
                    </p>
                    <p>
                        Enter years between 2010 and 2012. One or both fields can be left empty.
                    </p>
                    <label for="start_year">Start year</label>
                    <br>
                    <input type="number" id="start_year" name="start_year">
                    <br>
                    <br>
                    <label for="end_year">End year</label>
                    <br>
                    <input type="number" id="end_year" name="end_year">
                    <br>
                    <br>
                    <button id="button01" type="button">
                        Show Analysis
                    </button>
                    <div class="chart-container-1">
                        <canvas id="chart01"></canvas>
                    </div>
                </article>

                <article>
                    <h3>Analysis 2 - Week-of-Holiday Sales Compared to Annual Weekly Average</h3>
                    <p>
                        Pick radio button option to chart either all holidays or specific holidays.
                    </p>
                    <input type="radio" id="all_holidays" name="all_or_pick" value="all_holidays">
                    <label for="all_holidays">All Holidays</label>
                    <br>
                    <input type="radio" id="pick_holidays" name="all_or_pick" value="pick_holidays">
                    <label for="pick_holidays">Pick Holidays</label>
                    <br>

                    <p>Choose which holidays to include in chart:</p>
                    <input type="checkbox" id="superbowl" name="selected_holidays" value="superbowl">
                    <label for="superbowl">Super Bowl</label>
                    <br>
                    <input type="checkbox" id="laborday" name="selected_holidays" value="laborday">
                    <label for="superbowl">Labor Day</label>
                    <br>
                    <input type="checkbox" id="thanksgiving" name="selected_holidays" value="thanksgiving">
                    <label for="superbowl">Thanksgiving</label>
                    <br>
                    <input type="checkbox" id="christmas" name="selected_holidays" value="christmas">
                    <label for="superbowl">Christmas</label>

                    <br>
                    <br>
                    <button id="button02" type="button">
                        Show Analysis
                    </button>
                    <br>
                    <div id="analysis02-error">
                    </div>
                    <div class="chart-container-2">
                        <canvas id="chart02"></canvas>
                    </div>
                </article>
                <hr>
            </section>
        </main>
    </body>
</html>
